nginx-proxy:
    image: nginx
    links:
        - thesisapp
    volumes:
        - /etc/nginx/conf.d
        - /etc/nginx/vhost.d
        - /usr/share/nginx/html
    ports:
        - "80:80"
        - "443:443"

nginx-gen:
    image: jwilder/docker-gen
    volumes:
        - "/var/run/docker.sock:/tmp/docker.sock:ro"
    volumes_from:
        - nginx-proxy
    command: "-notify-sighup nginx -watch -only-exposed -wait 5s:30s /etc/docker-gen/templates/nginx.tmpl /etc/nginx/conf.d/default.conf"

nginx-letsencrypt-proxy:
    image: jrcs/letsencrypt-nginx-proxy-companion
    environment:
        - "NGINX_DOCKER_GEN_CONTAINER=nginx-gen"
    volumes:
        - "/var/run/docker.sock:/var/run/docker.sock:ro"
    volumes_from:
        - nginx-proxy

thesisapp:
    image: huytrinh/thesisapp
    environment:
        - "VIRTUAL_HOST=thesisapp.ontheroof.top"
        - "LETSENCRYPT_HOST=thesisapp.ontheroof.top"
        - "LETSENCRYPT_EMAIL=trinhphandinhhuy@gmail.com"
    expose:
        - "3000"